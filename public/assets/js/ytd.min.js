"use strict";
var socket = io();

socket.on("erreur", (socket_msg) => {
  $("#loadingImg, #infoMessage, #updateMessage").hide();
  $("#errorMessage").show().html(socket_msg);
  setTimeout(() => {
    $("#errorMessage").fadeOut(200);
  }, 1000);
  $("#urlForm").show();
});

socket.on("info", (socket_msg) => {
  $("#infoMessage").show().html(socket_msg);
});

socket.on("gif-on", () => {
  $("#loadingImg").show();
  $("#urlForm").hide();
});

socket.on("gif-off", () => {
  $("#loadingImg, #infoMessage, #updateMessage").hide();
  $("#urlForm").show();  
});

socket.on("dl-update", (socket_msg) => {
  $("#updateMessage").show().html(socket_msg);
});

socket.on("zip-rd", () => {
  window.open(`http://localhost:8003/telecharger?id=${socket.id}`);
  $("#loadingImg, #infoMessage, #updateMessage").hide();
  $("#urlForm").show();
});

$("#urlForm").submit(function (e) {
  e.preventDefault();
  if ($("#urlInput").val() != "" && $("#urlInput").val())
    socket.emit("url", $("#urlInput").val());
  $("#urlInput").val("");
});
